!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.sdk=n():e.sdk=n()}(this,(function(){return(()=>{"use strict";var e={d:(n,t)=>{for(var i in t)e.o(t,i)&&!e.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};e.r(n),e.d(n,{default:()=>c});var t="https://www.tripleplaypay.com/iframe",i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n="?params=".concat(JSON.stringify(e));return n},o=function(e,n){return"".concat(t,"/").concat(e).concat(n)};function r(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const a=function(){function e(n){var t=n.iframe,i=n.messageHandler;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.iframe=t,this.messageHandler=i}var n,t;return n=e,(t=[{key:"send",value:function(e){if(!this.iframe)throw new Error("Iframe is not selected");this.iframe.contentWindow.postMessage(e,"*")}},{key:"subscribe",value:function(){window.onmessage=this.messageHandler}},{key:"unsubscribe",value:function(){window.onmessage=function(){}}}])&&r(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),e}();function s(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.appKey=n}var n,r;return n=e,(r=[{key:"generatePaymentForm",value:function(e){var n=e.containerSelector,t=e.amount,i=e.onError,o=void 0===i?function(){}:i,r=e.onSuccess,a=void 0===r?function(){}:r,s=e.newWindow;this.element||(this.containerSelector=n,this.amount=t,this.iframe=null,this.onError=o,this.onSuccess=a,this.element=null,this.newWindow=s,this.init())}},{key:"clear",value:function(){this.amount=null,this.transactionId=null,this.ticket=null,this.meta=null,this.iframe=null,this.onError=null,this.onSuccess=null,this.newWindow=null,this.element=null,this.containerSelector=null}},{key:"init",value:function(){this.newWindow||this.useIframe()}},{key:"processPayment",value:function(){var e=this;if(this.newWindow){var n=i({amount:this.amount,location:window.location.href,newWindow:!0}),r=o(this.appKey,n),a=window.open(r,null,"left=100,top=100,width=520,height=400");window.onmessage=function(n){if(n.origin===t){var i=JSON.parse(n.data||"{}");i.status?(e.onSuccess(i),a.close()):e.onError(i)}}}}},{key:"getDomElement",value:function(){var e=document.querySelector(this.containerSelector);if(!e)throw new Error("Such container doesn't exist");return e}},{key:"useIframe",value:function(){var e=this.getDomElement();this.element=e,this.iframe=function(e,n,t){e.innerHTML="";var r=function(e,n){var t=document.createElement("iframe");return t.style="width: 500px; min-height: 300px; border: none; max-width: 100vw;",t.src=o(e,n),t}(n,i(t));return e.appendChild(r),r}(e,this.appKey,{amount:this.amount}),this.createMessenger()}},{key:"createMessenger",value:function(){this.messenger=new a({iframe:this.iframe,messageHandler:this.handleIncomingMessage.bind(this)}),this.messenger.subscribe()}},{key:"handleIncomingMessage",value:function(e){var n=JSON.parse(e.data||"{}"),t=n.payload;"error"!==n.action?"success"!==n.action||this.onSuccess({transactionId:t}):this.onError({transactionId:t})}}])&&s(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();return window&&!window.Triple&&(window.Triple=c),n})()}));